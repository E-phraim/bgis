// Complete gallery data
const xcvGalleryData = {
  yearbook: [
    {
      id: 101,
      type: 'cover',
      year: '2023',
      title: '2023 Yearbook - EMMANUEL USOTAI NSIEN',
      date: 'June 2023',
      description: 'The official cover of the 2023 yearbook',
      img: 'images/YearBook-EMMANUEL USOTAI NSIEN.png',
    },
    {
      id: 107,
      type: 'cover',
      year: '2023',
      title: '2023 Yearbook - GODSWILL EDET EKANEM',
      date: 'June 2023',
      description: 'The official cover of the 2023 yearbook',
      img: 'images/YearBook-GODSWILL EDET EKANEM.png',
    },
    {
      id: 108,
      type: 'cover',
      year: '2023',
      title: '2023 Yearbook - INEMESIT USOTAI NSIEN',
      date: 'June 2023',
      description: 'The official cover of the 2023 yearbook',
      img: 'images/YearBook-INEMESIT USOTAI NSIEN.png',
    },
    {
      id: 109,
      type: 'cover',
      year: '2023',
      title: '2023 Yearbook - INIUBONG UBONG UMOH',
      date: 'June 2023',
      description: 'The official cover of the 2023 yearbook',
      img: 'images/YearBook-INIUBONG UBONG UMOH.png',
    },
    {
      id: 110,
      type: 'cover',
      year: '2023',
      title: '2023 Yearbook - Favour Aghedo',
      date: 'June 2023',
      description: 'The official cover of the 2023 yearbook',
      img: 'images/YearBookFavour Aghedo (2).png',
    },
    {
      id: 111,
      type: 'cover',
      year: '2023',
      title: '2023 Yearbook - NDIFREKE ISAAC BEN',
      date: 'June 2023',
      description: 'The official cover of the 2023 yearbook',
      img: 'images/YearBookNDIFREKE ISAAC BEN.png',
    },
    {
      id: 112,
      type: 'cover',
      year: '2023',
      title: '2023 Yearbook - UBONGABASI ANIETIE EDIGHIENYONG',
      date: 'June 2023',
      description: 'The official cover of the 2023 yearbook',
      img: 'images/YearBookUBONGABASI ANIETIE EDIGHIENYONG.png',
    },
  ],
  sports: [
    {
      id: 201,
      type: 'basketball',
      year: '2023',
      title: 'Inter-school Basketball Finals',
      date: 'March 15, 2023',
      description: 'Our team celebrating after winning the championship',
      img: 'https://source.unsplash.com/random/800x600/?basketball,game',
    },
    {
      id: 202,
      type: 'football',
      year: '2023',
      title: 'Football Team Celebration',
      date: 'April 2, 2023',
      description: 'Team photo after the regional tournament',
      img: 'https://source.unsplash.com/random/800x600/?football,team',
    },
    {
      id: 203,
      type: 'cricket',
      year: '2022',
      title: 'Cricket Tournament Winners',
      date: 'November 20, 2022',
      description: 'Receiving the championship trophy',
      img: 'https://source.unsplash.com/random/800x600/?cricket,match',
    },
    {
      id: 204,
      type: 'athletics',
      year: '2022',
      title: 'Annual Sports Day',
      date: 'February 10, 2022',
      description: '100m race finals on sports day',
      img: 'https://source.unsplash.com/random/800x600/?athletics,running',
    },
    {
      id: 205,
      type: 'swimming',
      year: '2021',
      title: 'Swimming Competition',
      date: 'July 5, 2021',
      description: 'Butterfly stroke competition',
      img: 'https://source.unsplash.com/random/800x600/?swimming,pool',
    },
    {
      id: 206,
      type: 'basketball',
      year: '2021',
      title: 'Basketball Practice Session',
      date: 'September 12, 2021',
      description: 'Team practicing for upcoming tournament',
      img: 'https://source.unsplash.com/random/800x600/?basketball,practice',
    },
  ],
  classroom: [
    {
      id: 301,
      type: 'science',
      year: '2023',
      title: 'Science Lab Experiment',
      date: 'January 25, 2023',
      description: 'Students conducting chemistry experiments',
      img: 'https://source.unsplash.com/random/800x600/?science,lab',
    },
    {
      id: 302,
      type: 'art',
      year: '2023',
      title: 'Art Class',
      date: 'February 14, 2023',
      description: 'Students working on their paintings',
      img: 'https://source.unsplash.com/random/800x600/?art,class',
    },
    {
      id: 303,
      type: 'math',
      year: '2022',
      title: 'Math Competition',
      date: 'October 5, 2022',
      description: 'Inter-class math challenge',
      img: 'https://source.unsplash.com/random/800x600/?math,school',
    },
    {
      id: 304,
      type: 'history',
      year: '2022',
      title: 'History Presentation',
      date: 'November 18, 2022',
      description: 'Student presenting their history project',
      img: 'https://source.unsplash.com/random/800x600/?history,presentation',
    },
    {
      id: 305,
      type: 'language',
      year: '2021',
      title: 'Debate Competition',
      date: 'March 9, 2021',
      description: 'Annual inter-school debate finals',
      img: 'https://source.unsplash.com/random/800x600/?debate,school',
    },
    {
      id: 306,
      type: 'computer',
      year: '2021',
      title: 'Computer Lab',
      date: 'May 21, 2021',
      description: 'Students working on programming projects',
      img: 'https://source.unsplash.com/random/800x600/?computer,lab',
    },
  ],
  festivals: [
    {
      id: 401,
      type: 'diwali',
      year: '2023',
      title: 'Diwali Celebration',
      date: 'November 12, 2023',
      description: 'Traditional dance performance',
      img: 'https://source.unsplash.com/random/800x600/?diwali,school',
    },
    {
      id: 402,
      type: 'holi',
      year: '2023',
      title: 'Holi Festival',
      date: 'March 8, 2023',
      description: 'Colorful celebrations in the courtyard',
      img: 'https://source.unsplash.com/random/800x600/?holi,festival',
    },
    {
      id: 403,
      type: 'independence',
      year: '2022',
      title: 'Independence Day',
      date: 'August 15, 2022',
      description: 'Flag hoisting ceremony',
      img: 'https://source.unsplash.com/random/800x600/?independence,school',
    },
    {
      id: 404,
      type: 'christmas',
      year: '2022',
      title: 'Christmas Celebration',
      date: 'December 20, 2022',
      description: 'Christmas choir performance',
      img: 'https://source.unsplash.com/random/800x600/?christmas,school',
    },
    {
      id: 405,
      type: 'republic',
      year: '2021',
      title: 'Republic Day',
      date: 'January 26, 2021',
      description: 'March past competition',
      img: 'https://source.unsplash.com/random/800x600/?republic,day',
    },
    {
      id: 406,
      type: 'eid',
      year: '2021',
      title: 'Eid Celebration',
      date: 'May 13, 2021',
      description: 'Cultural program and feast',
      img: 'https://source.unsplash.com/random/800x600/?eid,school',
    },
  ],
  trips: [
    {
      id: 501,
      type: 'historical',
      year: '2023',
      title: 'Historical Site Visit',
      date: 'February 3, 2023',
      description: 'Grade 10 field trip to local monuments',
      img: 'https://source.unsplash.com/random/800x600/?monument,trip',
    },
    {
      id: 502,
      type: 'science',
      year: '2023',
      title: 'Science Museum',
      date: 'March 17, 2023',
      description: 'Interactive exhibits at the science center',
      img: 'https://source.unsplash.com/random/800x600/?science,museum',
    },
    {
      id: 503,
      type: 'nature',
      year: '2022',
      title: 'Nature Camp',
      date: 'October 22, 2022',
      description: 'Three-day camping trip in the forest',
      img: 'https://source.unsplash.com/random/800x600/?camping,school',
    },
    {
      id: 504,
      type: 'industry',
      year: '2022',
      title: 'Factory Visit',
      date: 'November 5, 2022',
      description: 'Learning about manufacturing processes',
      img: 'https://source.unsplash.com/random/800x600/?factory,tour',
    },
    {
      id: 505,
      type: 'zoo',
      year: '2021',
      title: 'Zoo Visit',
      date: 'April 9, 2021',
      description: 'Grade 5 field trip to the city zoo',
      img: 'https://source.unsplash.com/random/800x600/?zoo,school',
    },
    {
      id: 506,
      type: 'art',
      year: '2021',
      title: 'Art Gallery',
      date: 'May 28, 2021',
      description: "Appreciating local artists' work",
      img: 'https://source.unsplash.com/random/800x600/?gallery,students',
    },
  ],
  graduation: [
    {
      id: 601,
      type: 'ceremony',
      year: '2023',
      title: 'Graduation Ceremony',
      date: 'June 5, 2023',
      description: 'Principal handing out diplomas',
      img: 'https://source.unsplash.com/random/800x600/?graduation,ceremony',
    },
    {
      id: 602,
      type: 'speech',
      year: '2023',
      title: 'Valedictorian Speech',
      date: 'June 5, 2023',
      description: 'Top student addressing the class',
      img: 'https://source.unsplash.com/random/800x600/?speech,graduation',
    },
    {
      id: 603,
      type: 'party',
      year: '2023',
      title: 'Graduation Party',
      date: 'June 6, 2023',
      description: 'Students celebrating after the ceremony',
      img: 'https://source.unsplash.com/random/800x600/?party,graduation',
    },
    {
      id: 604,
      type: 'ceremony',
      year: '2022',
      title: 'Graduation Ceremony',
      date: 'June 6, 2022',
      description: 'Class of 2022 receiving diplomas',
      img: 'https://source.unsplash.com/random/800x600/?graduation,2022',
    },
    {
      id: 605,
      type: 'awards',
      year: '2022',
      title: 'Awards Night',
      date: 'June 4, 2022',
      description: 'Special awards presentation',
      img: 'https://source.unsplash.com/random/800x600/?awards,ceremony',
    },
    {
      id: 606,
      type: 'group',
      year: '2021',
      title: 'Graduating Class',
      date: 'June 7, 2021',
      description: 'Official class photo on graduation day',
      img: 'https://source.unsplash.com/random/800x600/?graduation,group',
    },
  ],
}

// Category metadata
const xcvCategoryMetadata = {
  yearbook: {
    title: 'Yearbook Archives',
    types: ['cover', 'class', 'events'],
    typeLabels: {
      cover: 'Cover',
      class: 'Class Photos',
      events: 'Events',
    },
  },
  sports: {
    title: 'Sports Moments',
    types: ['basketball', 'football', 'cricket', 'athletics', 'swimming'],
    typeLabels: {
      basketball: 'Basketball',
      football: 'Football',
      cricket: 'Cricket',
      athletics: 'Athletics',
      swimming: 'Swimming',
    },
  },
  classroom: {
    title: 'Classroom Chronicles',
    types: ['science', 'art', 'math', 'history', 'language', 'computer'],
    typeLabels: {
      science: 'Science',
      art: 'Art',
      math: 'Math',
      history: 'History',
      language: 'Language',
      computer: 'Computer',
    },
  },
  festivals: {
    title: 'Festival Celebrations',
    types: ['diwali', 'holi', 'independence', 'christmas', 'republic', 'eid'],
    typeLabels: {
      diwali: 'Diwali',
      holi: 'Holi',
      independence: 'Independence Day',
      christmas: 'Christmas',
      republic: 'Republic Day',
      eid: 'Eid',
    },
  },
  trips: {
    title: 'Field Trip Adventures',
    types: ['historical', 'science', 'nature', 'industry', 'zoo', 'art'],
    typeLabels: {
      historical: 'Historical',
      science: 'Science',
      nature: 'Nature',
      industry: 'Industry',
      zoo: 'Zoo',
      art: 'Art',
    },
  },
  graduation: {
    title: 'Graduation Memories',
    types: ['ceremony', 'speech', 'party', 'awards', 'group'],
    typeLabels: {
      ceremony: 'Ceremony',
      speech: 'Speeches',
      party: 'Party',
      awards: 'Awards',
      group: 'Group Photos',
    },
  },
}

// DOM elements
const xcvMainView = document.getElementById('xcv-main-view')
const xcvCategoryView = document.getElementById('xcv-category-view')
const xcvGalleryContainer = document.getElementById('xcv-gallery-container')
const xcvYearFilter = document.getElementById('xcv-year-filter')
const xcvTypeFilter = document.getElementById('xcv-type-filter')
const xcvSearchInput = document.getElementById('xcv-search')
const xcvLightbox = document.getElementById('xcv-lightbox')
const xcvLightboxImg = document.getElementById('xcv-lightbox-img')
const xcvLightboxTitle = document.getElementById('xcv-lightbox-title')
const xcvLightboxDate = document.getElementById('xcv-lightbox-date')
const xcvLightboxDesc = document.getElementById('xcv-lightbox-desc')
const xcvLightboxClose = document.querySelector('.xcv-lightbox-close')
const xcvLightboxPrev = document.querySelector('.xcv-lightbox-prev')
const xcvLightboxNext = document.querySelector('.xcv-lightbox-next')
const xcvCategoryCards = document.querySelectorAll('.xcv-category-card')
const xcvBackBtn = document.getElementById('xcv-back-btn')
const xcvCurrentCategory = document.getElementById('xcv-current-category')

// Current state
let xcvCurrentItems = []
let xcvCurrentIndex = 0
let xcvCurrentCategoryName = null

// Initialize the gallery
function xcvInitGallery() {
  xcvSetupEventListeners()
}

// Show category view
function xcvShowCategory(category) {
  xcvCurrentCategoryName = category
  xcvMainView.style.display = 'none'
  xcvCategoryView.style.display = 'block'
  xcvCurrentCategory.textContent = xcvCategoryMetadata[category].title

  // Populate type filter
  xcvTypeFilter.innerHTML = '<option value="all">All Types</option>'
  xcvCategoryMetadata[category].types.forEach((type) => {
    xcvTypeFilter.innerHTML += `<option value="${type}">${xcvCategoryMetadata[category].typeLabels[type]}</option>`
  })

  // Show all items for this category initially
  xcvFilterCategoryGallery()
}

// Show main view
function xcvShowMainView() {
  xcvMainView.style.display = 'block'
  xcvCategoryView.style.display = 'none'
  xcvCurrentCategoryName = null
}

// Filter gallery items for current category
function xcvFilterCategoryGallery() {
  const yearValue = xcvYearFilter.value
  const typeValue = xcvTypeFilter.value
  const searchValue = xcvSearchInput.value.toLowerCase()

  const filtered = xcvGalleryData[xcvCurrentCategoryName].filter((item) => {
    return (
      (yearValue === 'all' || item.year === yearValue) &&
      (typeValue === 'all' || item.type === typeValue) &&
      (item.title.toLowerCase().includes(searchValue) ||
        item.date.toLowerCase().includes(searchValue) ||
        item.description.toLowerCase().includes(searchValue))
    )
  })

  xcvRenderGallery(filtered)
}

// Render gallery items
function xcvRenderGallery(items) {
  xcvGalleryContainer.innerHTML = ''
  xcvCurrentItems = items

  if (items.length === 0) {
    xcvGalleryContainer.innerHTML =
      '<p style="grid-column: 1/-1; text-align: center; padding: 2rem;">No photos found matching your criteria</p>'
    return
  }

  items.forEach((item) => {
    const galleryItem = document.createElement('div')
    galleryItem.className = 'xcv-gallery-item'
    galleryItem.dataset.id = item.id

    galleryItem.innerHTML = `
            <img class="xcv-gallery-img" src="${item.img}" alt="${item.title}">
            <div class="xcv-gallery-info">
                <h4>${item.title}</h4>
                <p>${item.date}</p>
            </div>
        `

    xcvGalleryContainer.appendChild(galleryItem)
  })
}

// Open lightbox
function xcvOpenLightbox(index) {
  const item = xcvCurrentItems[index]
  xcvLightboxImg.src = item.img
  xcvLightboxImg.alt = item.title
  xcvLightboxTitle.textContent = item.title
  xcvLightboxDate.textContent = item.date
  xcvLightboxDesc.textContent = item.description
  xcvLightbox.classList.add('xcv-lightbox-active')
  xcvCurrentIndex = index
  document.body.style.overflow = 'hidden'
}

// Close lightbox
function xcvCloseLightbox() {
  xcvLightbox.classList.remove('xcv-lightbox-active')
  document.body.style.overflow = 'auto'
}

// Navigate lightbox
function xcvNavigateLightbox(direction) {
  if (direction === 'prev') {
    xcvCurrentIndex =
      (xcvCurrentIndex - 1 + xcvCurrentItems.length) % xcvCurrentItems.length
  } else {
    xcvCurrentIndex = (xcvCurrentIndex + 1) % xcvCurrentItems.length
  }

  const item = xcvCurrentItems[xcvCurrentIndex]
  xcvLightboxImg.src = item.img
  xcvLightboxImg.alt = item.title
  xcvLightboxTitle.textContent = item.title
  xcvLightboxDate.textContent = item.date
  xcvLightboxDesc.textContent = item.description
}

// Setup event listeners
function xcvSetupEventListeners() {
  // Category card clicks
  xcvCategoryCards.forEach((card) => {
    card.addEventListener('click', () => {
      const category = card.dataset.category
      xcvShowCategory(category)
    })
  })

  // Back button
  xcvBackBtn.addEventListener('click', (e) => {
    e.preventDefault()
    xcvShowMainView()
  })

  // Filter events
  xcvYearFilter.addEventListener('change', xcvFilterCategoryGallery)
  xcvTypeFilter.addEventListener('change', xcvFilterCategoryGallery)
  xcvSearchInput.addEventListener('input', xcvFilterCategoryGallery)

  // Lightbox events
  xcvGalleryContainer.addEventListener('click', (e) => {
    const galleryItem = e.target.closest('.xcv-gallery-item')
    if (galleryItem) {
      const id = parseInt(galleryItem.dataset.id)
      const index = xcvCurrentItems.findIndex((item) => item.id === id)
      if (index !== -1) {
        xcvOpenLightbox(index)
      }
    }
  })

  xcvLightboxClose.addEventListener('click', xcvCloseLightbox)
  xcvLightboxPrev.addEventListener('click', () => xcvNavigateLightbox('prev'))
  xcvLightboxNext.addEventListener('click', () => xcvNavigateLightbox('next'))

  // Close lightbox when clicking outside the image
  xcvLightbox.addEventListener('click', (e) => {
    if (e.target === xcvLightbox) {
      xcvCloseLightbox()
    }
  })

  // Keyboard navigation
  document.addEventListener('keydown', (e) => {
    if (xcvLightbox.classList.contains('xcv-lightbox-active')) {
      if (e.key === 'Escape') {
        xcvCloseLightbox()
      } else if (e.key === 'ArrowLeft') {
        xcvNavigateLightbox('prev')
      } else if (e.key === 'ArrowRight') {
        xcvNavigateLightbox('next')
      }
    }
  })
}

// Initialize the gallery when the DOM is loaded
document.addEventListener('DOMContentLoaded', xcvInitGallery)
